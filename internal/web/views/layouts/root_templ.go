// Code generated by templ - DO NOT EDIT.

// templ: version: v0.3.943
package layouts

//lint:file-ignore SA4006 This context is only used if a nested component is present.

import "github.com/a-h/templ"
import templruntime "github.com/a-h/templ/runtime"

import "github.com/abdelrahman146/kyora/internal/web/webcontext"
import "github.com/abdelrahman146/kyora/internal/web/views/components"

func HtmxHandle400Swap() templ.ComponentScript {
	return templ.ComponentScript{
		Name: `__templ_HtmxHandle400Swap_df13`,
		Function: `function __templ_HtmxHandle400Swap_df13(){document.addEventListener('htmx:beforeSwap', function(evt) {
		const xhr = evt.detail.xhr;
		if (xhr.status < 500 && xhr.status >= 400) {
			evt.detail.shouldSwap = true; 
		}
	});
}`,
		Call:       templ.SafeScript(`__templ_HtmxHandle400Swap_df13`),
		CallInline: templ.SafeScriptInline(`__templ_HtmxHandle400Swap_df13`),
	}
}

func InitTheme() templ.ComponentScript {
	return templ.ComponentScript{
		Name: `__templ_InitTheme_2ae2`,
		Function: `function __templ_InitTheme_2ae2(){document.addEventListener('alpine:init', () => {
		// ---- Theme Store (daisyUI) ----
		// Modes: 'system' | 'light' | 'dracula'
		const THEME_KEY = 'kyora.theme';
		const prefersDark = window.matchMedia('(prefers-color-scheme: dracula)');

		function applyTheme(mode) {
			const resolved = mode === 'system' ? (prefersDark.matches ? 'dracula' : 'emerald') : mode;
			document.documentElement.setAttribute('data-theme', resolved);
			// Also set color-scheme to help native UI (scrollbars, etc.)
			document.documentElement.style.colorScheme = resolved;
			return resolved;
		}

		function loadTheme() {
			const saved = localStorage.getItem(THEME_KEY);
			return saved === 'emerald' || saved === 'dracula' || saved === 'system' ? saved : 'system';
		}
		const themeStore = {
			mode: 'system',
			resolved: 'emerald',
			set(mode) {
				this.mode = mode;
				localStorage.setItem(THEME_KEY, mode);
				this.resolved = applyTheme(mode);
				document.dispatchEvent(new CustomEvent('theme:changed', { detail: { mode, resolved: this.resolved } }));
			},
			toggle() {
				const next = this.mode === 'emerald' ? 'dracula' : (this.mode === 'dracula' ? 'system' : 'emerald');
				this.set(next);
			},
			init() {
				this.mode = loadTheme();
				this.resolved = applyTheme(this.mode);
				// React to OS scheme changes when in system mode
				prefersDark.addEventListener('change', () => {
					if (this.mode === 'system') {
						this.resolved = applyTheme('system');
					}
				});
				// Hook any element with data-theme-toggle to toggle on click
				document.addEventListener('click', (e) => {
					const t = e.target.closest('[data-theme-toggle]');
					if (t) this.toggle();
				});
			}
		};

		// Expose as Alpine Store
		Alpine.store('theme', themeStore);
		themeStore.init();
		window.Kyora.theme = themeStore;
	});
}`,
		Call:       templ.SafeScript(`__templ_InitTheme_2ae2`),
		CallInline: templ.SafeScriptInline(`__templ_InitTheme_2ae2`),
	}
}

func InitToastMessages() templ.ComponentScript {
	return templ.ComponentScript{
		Name: `__templ_InitToastMessages_8550`,
		Function: `function __templ_InitToastMessages_8550(){document.addEventListener('alpine:init', () => {
		// ---- Flash Toasts Store ----
		// Usage: Alpine.store('flash').push('success', 'Saved');
		const FLASH_KEY_QUEUE = 'kyora.flash.queue'; // session-scoped queue across redirects
		function loadQueuedFlashes() {
			try {
				const raw = sessionStorage.getItem(FLASH_KEY_QUEUE);
				if (!raw) return [];
				const arr = JSON.parse(raw);
				sessionStorage.removeItem(FLASH_KEY_QUEUE);
				return Array.isArray(arr) ? arr : [];
			} catch { return []; }
		}
		function queueFlashesAcrossRedirect(messages) {
			try {
				const existing = JSON.parse(sessionStorage.getItem(FLASH_KEY_QUEUE) || '[]');
				const next = existing.concat(messages);
				sessionStorage.setItem(FLASH_KEY_QUEUE, JSON.stringify(next));
			} catch { /* no-op */ }
		}

		const flashStore = {
			messages: [], // { type: 'success'|'error'|'info', text: string, timeoutMs?: number }
			push(type, text, timeoutMs) {
				const idx = this.messages.push({ type, text, timeoutMs }) - 1;
				if (timeoutMs && timeoutMs > 0) {
					setTimeout(() => this.dismiss(idx), timeoutMs);
				}
			},
			addMany(items) {
				if (!Array.isArray(items)) return;
				items.forEach(m => this.push(m.type || 'info', m.text || String(m), m.timeoutMs));
			},
			dismiss(index) {
				this.messages.splice(index, 1);
			},
			clear() {
				this.messages = [];
			},
			queueAcrossRedirect(items) {
				queueFlashesAcrossRedirect(items);
			},
			init() {
				const boot = loadQueuedFlashes();
				if (boot.length) this.addMany(boot);
			}
		};
		Alpine.store('flash', flashStore);
		flashStore.init();

		// Bridge HTMX -> Alpine flash store via HX-Trigger events
		// Server can send header: HX-Trigger: {"flash": {"messages": [{"type":"success","text":"Saved"}]}}
		document.addEventListener('flash', (evt) => {
			const detail = evt.detail || {};
			const msgs = Array.isArray(detail) ? detail : (detail.messages || []);
			flashStore.addMany(msgs);
		});

		// Generic HTMX error hooks => toast
		document.body.addEventListener('htmx:responseError', (evt) => {
			const xhr = evt.detail && evt.detail.xhr;
			const status = xhr ? xhr.status : 0;
			let text = 'Request failed';
			try {
				// Try to read server-provided text
				const ct = xhr.getResponseHeader('Content-Type') || '';
				if (ct.includes('application/json')) {
					const j = JSON.parse(xhr.responseText);
					text = j.detail || j.message || text;
				} else {
					text = xhr.responseText || text;
				}
			} catch {}
			flashStore.push('error', ` + "`" + `${status >= 500 ? 'Server error' : 'Request error'}: ${text}` + "`" + `, 6000);
		});
	});
}`,
		Call:       templ.SafeScript(`__templ_InitToastMessages_8550`),
		CallInline: templ.SafeScriptInline(`__templ_InitToastMessages_8550`),
	}
}

func InitStoreDetection() templ.ComponentScript {
	return templ.ComponentScript{
		Name: `__templ_InitStoreDetection_9051`,
		Function: `function __templ_InitStoreDetection_9051(){document.addEventListener('alpine:init', () => {
		window.Kyora = window.Kyora || {};
		// ---- Store ID exposure ----
		function detectStoreId() {
			// Prefer meta tag or data attribute if provided by a page
			const meta = document.querySelector('meta[name="store-id"]');
			if (meta && meta.content) return meta.content;
			return '';
		}
		window.Kyora.storeId = detectStoreId();
	});
}`,
		Call:       templ.SafeScript(`__templ_InitStoreDetection_9051`),
		CallInline: templ.SafeScriptInline(`__templ_InitStoreDetection_9051`),
	}
}

func Root() templ.Component {
	return templruntime.GeneratedTemplate(func(templ_7745c5c3_Input templruntime.GeneratedComponentInput) (templ_7745c5c3_Err error) {
		templ_7745c5c3_W, ctx := templ_7745c5c3_Input.Writer, templ_7745c5c3_Input.Context
		if templ_7745c5c3_CtxErr := ctx.Err(); templ_7745c5c3_CtxErr != nil {
			return templ_7745c5c3_CtxErr
		}
		templ_7745c5c3_Buffer, templ_7745c5c3_IsBuffer := templruntime.GetBuffer(templ_7745c5c3_W)
		if !templ_7745c5c3_IsBuffer {
			defer func() {
				templ_7745c5c3_BufErr := templruntime.ReleaseBuffer(templ_7745c5c3_Buffer)
				if templ_7745c5c3_Err == nil {
					templ_7745c5c3_Err = templ_7745c5c3_BufErr
				}
			}()
		}
		ctx = templ.InitializeContext(ctx)
		templ_7745c5c3_Var1 := templ.GetChildren(ctx)
		if templ_7745c5c3_Var1 == nil {
			templ_7745c5c3_Var1 = templ.NopComponent
		}
		ctx = templ.ClearChildren(ctx)
		templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 1, "<!doctype html><html lang=\"en\" hx-boost=\"true\" lang=\"")
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		var templ_7745c5c3_Var2 string
		templ_7745c5c3_Var2, templ_7745c5c3_Err = templ.JoinStringErrs(webcontext.GetPageLocale(ctx))
		if templ_7745c5c3_Err != nil {
			return templ.Error{Err: templ_7745c5c3_Err, FileName: `internal/web/views/layouts/root.templ`, Line: 169, Col: 38}
		}
		_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var2))
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 2, "\" dir=\"")
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		var templ_7745c5c3_Var3 string
		templ_7745c5c3_Var3, templ_7745c5c3_Err = templ.JoinStringErrs(webcontext.GetPageDir(ctx))
		if templ_7745c5c3_Err != nil {
			return templ.Error{Err: templ_7745c5c3_Err, FileName: `internal/web/views/layouts/root.templ`, Line: 170, Col: 34}
		}
		_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var3))
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 3, "\" class=\"scroll-smooth\"><head><meta charset=\"utf-8\"><meta name=\"viewport\" content=\"width=device-width, initial-scale=1, viewport-fit=cover\"><title>")
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		var templ_7745c5c3_Var4 string
		templ_7745c5c3_Var4, templ_7745c5c3_Err = templ.JoinStringErrs(webcontext.ComposeFullTitle(webcontext.GetPageTitle(ctx)))
		if templ_7745c5c3_Err != nil {
			return templ.Error{Err: templ_7745c5c3_Err, FileName: `internal/web/views/layouts/root.templ`, Line: 176, Col: 69}
		}
		_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var4))
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 4, "</title><meta name=\"description\" content=\"")
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		var templ_7745c5c3_Var5 string
		templ_7745c5c3_Var5, templ_7745c5c3_Err = templ.JoinStringErrs(webcontext.GetPageDescription(ctx))
		if templ_7745c5c3_Err != nil {
			return templ.Error{Err: templ_7745c5c3_Err, FileName: `internal/web/views/layouts/root.templ`, Line: 177, Col: 72}
		}
		_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var5))
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 5, "\"><meta name=\"keywords\" content=\"")
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		var templ_7745c5c3_Var6 string
		templ_7745c5c3_Var6, templ_7745c5c3_Err = templ.JoinStringErrs(webcontext.GetPageKeywords(ctx))
		if templ_7745c5c3_Err != nil {
			return templ.Error{Err: templ_7745c5c3_Err, FileName: `internal/web/views/layouts/root.templ`, Line: 178, Col: 66}
		}
		_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var6))
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 6, "\">")
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		if store, ok := webcontext.GetStore(ctx); ok && store != nil {
			templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 7, "<meta name=\"store-name\" content=\"")
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			var templ_7745c5c3_Var7 string
			templ_7745c5c3_Var7, templ_7745c5c3_Err = templ.JoinStringErrs(store.Name)
			if templ_7745c5c3_Err != nil {
				return templ.Error{Err: templ_7745c5c3_Err, FileName: `internal/web/views/layouts/root.templ`, Line: 180, Col: 48}
			}
			_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var7))
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 8, "\"><meta name=\"store-id\" content=\"")
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			var templ_7745c5c3_Var8 string
			templ_7745c5c3_Var8, templ_7745c5c3_Err = templ.JoinStringErrs(store.ID)
			if templ_7745c5c3_Err != nil {
				return templ.Error{Err: templ_7745c5c3_Err, FileName: `internal/web/views/layouts/root.templ`, Line: 181, Col: 44}
			}
			_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var8))
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 9, "\">")
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
		}
		templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 10, "<!-- [Favicon] icon --><link rel=\"icon\" href=\"/static/images/favicon.svg\" type=\"image/x-icon\"><!-- Base CSS (Tailwind compiled) --><link rel=\"stylesheet\" href=\"/static/css/base.css\"><!-- Custom CSS --><link rel=\"stylesheet\" href=\"/static/css/style.css\"><!-- Inter Font (Google Fonts) --><link rel=\"stylesheet\" href=\"https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap\"><!-- Feather Icons --><script src=\"https://unpkg.com/feather-icons\"></script><!-- Alpine.js --><script defer src=\"https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js\"></script><!-- HTMX --><script src=\"https://cdn.jsdelivr.net/npm/htmx.org@2.0.7/dist/htmx.min.js\"></script><!-- Chart.js --><script src=\"https://cdn.jsdelivr.net/npm/chart.js@4.4.3/dist/chart.umd.min.js\"></script></head><body class=\"bg-base-200\" x-data>")
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		templ_7745c5c3_Err = templ_7745c5c3_Var1.Render(ctx, templ_7745c5c3_Buffer)
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		templ_7745c5c3_Err = templ.JSFuncCall("feather.replace").Render(ctx, templ_7745c5c3_Buffer)
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		templ_7745c5c3_Err = InitTheme().Render(ctx, templ_7745c5c3_Buffer)
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		templ_7745c5c3_Err = InitStoreDetection().Render(ctx, templ_7745c5c3_Buffer)
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		templ_7745c5c3_Err = InitToastMessages().Render(ctx, templ_7745c5c3_Buffer)
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		templ_7745c5c3_Err = HtmxHandle400Swap().Render(ctx, templ_7745c5c3_Buffer)
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		templ_7745c5c3_Err = components.FlashToasts().Render(ctx, templ_7745c5c3_Buffer)
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 11, "</body></html>")
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		return nil
	})
}

var _ = templruntime.GeneratedTemplate
