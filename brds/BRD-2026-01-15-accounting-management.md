---
status: draft
date: 2026-01-15
authors: [Product Manager]
---

# BRD: Accounting & Expense Management

## 1. Executive Summary

### 1.1 Goal
Enable business owners to track **expenses, capital injections, withdrawals, and assets** effortlessly. This moves Kyora from just "Order Management" to a "Business Financial Health" partner.

### 1.2 Problem Statement
"I don't know where my money goes" and "I don't know how much I can take out of the business" are top anxieties for our users. Currently, they use external spreadsheets or notebooks to track rent, marketing spend, or their own capital injections. This separates their "sales" data (in Kyora) from their "costs" data, making true profitability invisible.

### 1.3 Target Audience
- **Segments:** Solo entrepreneurs, home-based businesses (artisans/bakers), micro-teams.
- **Mindset:** "Accounting is scary/boring." They want peace of mind, not a ledger.
- **Context:** Mobile-first, busy, mostly cash/transfer based.

### 1.4 Success Metrics (KPIs)
- **Adoption:** % of active businesses adding at least 1 expense per month.
- **Recurring set-up:** % of businesses with at least 1 active recurring expense (stickiness).
- **Peace of Mind:** % of users returning to view the "Safe to Draw" summary (derived metric).

---

## 2. Product Principles & Strategy

### 2.1 Strategic Fit
Kyora aims to be the "Silent Business Partner". A partner handles the boring math. By capturing expenses and capital flows, we can finally answer: "Are you actually making money?" and "Can you pay yourself?".

### 2.2 Principles
1.  **"Money In, Money Out"**: Avoid terms like "Credits/Debits", "General Ledger", or "Chart of Accounts". Use plain language.
2.  **Safe to Draw is the North Star**: The most tangible value we give is telling them "You can safely take 500 SAR out today."
3.  **Set and Forget**: Push recurring expenses heavily so they don't have to log rent every month.
4.  **No Dead Ends**: If they look for "Profit", show them they need to add "Expenses" first to make it real.

---

## 3. User Stories

| ID | As a... | I want to... | So that... |
|----|---------|--------------|------------|
| US-1 | Business Owner | Log a one-time expense (e.g. packaging, marketing) | I know my true costs beyond just product COGS. |
| US-2 | Business Owner | Set up a recurring expense (e.g. Shopify sub, Rent) | I don't have to manually enter it every month. |
| US-3 | Business Owner | Record money I put into the business (Investment) | I separate my personal savings from business revenue. |
| US-4 | Business Owner | Record money I take out (Withdrawal) | I can track my personal income/salary from the business. |
| US-5 | Business Owner | See how much cash is "Safe to Draw" | I don't accidentally spend money I need for restock or bills. |
| US-6 | Business Owner | Track fixed assets (Laptop, Camera) | I know the value of equipment the business owns. |

---

## 4. Functional Requirements

### 4.1 Accounting Dashboard (Overview)
**Purpose:** The "Peace of Mind" landing page for finances.
- **Summary Cards (Read-only from Backend Summary):**
    - **Safe to Draw:** Hero metric. (Calculated by backend). Display prominently.
    - **Total Expenses (This Month / All Time):** Quick health check.
    - **Total Assets:** Business value.
- **Quick Actions:**
    - "Add Expense" (Primary, FAB on mobile)
    - "Record Transaction" (Secondary: Invest/Withdraw)

### 4.2 Expense Management
**Purpose:** CRUD for money leaving the business (operations).
- **List View:**
    - Tabs/Filter: All vs Recurring.
    - Sorting: Date (descending).
    - Content: Category Icon, Description/Note, Amount, Date.
- **Add/Edit Expense Form:**
    - **Amount & Currency:** (Currency fixed to business currency).
    - **Category:** Dropdown (Marketing, Rent, Salaries, Software, Logistics, Other).
    - **Date:** Defaults to today.
    - **Note:** Text area (keep it simple).
    - **Recurring Toggle:** "Repeat this expense?"
        - If Yes -> Slide open frequency options (Weekly, Monthly, Yearly).
        - Backend: This calls `POST /recurring-expenses` instead of `POST /expenses`.
        - UX: "We will automatically add this for you every [Period]."
        - UX: "Add past expenses?" (Backfill option supported by backend).
- **Recurring Expenses Management:**
    - List active templates.
    - Status toggle: Active/Paused/Cancelled.
    - "History": View occurrences generated by this template (optional for V1, stick to list of templates).

### 4.3 Capital Management (Investments & Withdrawals)
**Purpose:** Manage Owner's Equity (Money between Owner <-> Business).
- **Concept:** Specific tab/view for "Owner Funds".
- **List View:** Chronological list of mixed Investments and Withdrawals (color-coded: Green for In/Investment, Red for Out/Withdrawal).
- **Add Investment Form:**
    - Amount, Date, Note ("Initial capital", "Emergency cash").
- **Add Withdrawal Form:**
    - Amount, Date, Note ("Salary", "Personal use").
    - **Smart UX:** Show "Safe to Draw" amount prominently near the input field as a helper. "You can safely withdraw up to SAR [Amount]".

### 4.4 Asset Management
**Purpose:** Track things the business owns.
- **List View:** Simple inventory of assets.
- **Add/Edit Asset Form:**
    - Name (e.g., "Canon Camera"), Value, Purchase Date, Note.
- **Impact:** Updates the "Total Asset Value" in the summary.

---

## 5. User Experience & Design

### 5.1 Global Patterns
- **Empty States:** Critical.
    - Expenses: "No expenses yet? Add your rent or software subscriptions to see your true profit."
    - Assets: "Do you own equipment? Add it here to track business value."
- **Navigation:** New sidebar item "Accounting".
- **Mobile:** Floating Action Button (FAB) on Accounting page for "+ Expense".

### 5.2 Breakdown of Screens

#### Screen 1: Accounting Home
- **Top:** "Safe to Draw" Card. Big, friendly number.
- **Middle:** "Recent Activity" list (mixed recent expenses/withdrawals).
- **Bottom:** Links/Tabs to "Expenses", "Capital", "Assets".

#### Screen 2: Expense Sheet (Drawer/Modal)
- Fast entry is priority.
- Large keypad for Amount (if mobile).
- Smart category icons.

### 5.3 Copy & Tone
- **Avoid:** "Ledger", "Depreciation", "Liability", "Equity".
- **Use:** "Money In", "Money Out", "Repeating Bill", "Equipment", "Safe to Withdraw".

### 5.4 Internationalization (i18n)
- **RTL Support:** All tables, cards, and forms must mirror for Arabic.
- **Currency:** Display `SAR 500` or `500 SAR` correctly localized.
- **Number formatting:** Arabic numerals where appropriate.

---

## 6. Technical Implementation Notes

### 6.1 Backend Integration (Existing)
- **Summary:** `GET /v1/businesses/{desc}/accounting/summary`
- **Expenses:** `GET/POST/PATCH/DELETE /v1/businesses/{desc}/accounting/expenses`
- **Recurring:** `GET/POST/PATCH/DELETE /v1/businesses/{desc}/accounting/recurring-expenses`
    - *Note:* Create Recurring endpoint supports `autoCreateHistoricalExpenses`. UX should ask user: "Log past expenses from start date?" (Default: Yes).
- **Investments:** `/investments`
- **Withdrawals:** `/withdrawals`
- **Assets:** `/assets`

### 6.2 Frontend Architecture
- **Feature Directory:** `src/features/accounting/`
- **Routes:**
    - `/business/$businessDescriptor/accounting/` (Index/Summary)
    - `/business/$businessDescriptor/accounting/expenses`
    - `/business/$businessDescriptor/accounting/capital` (Investments/Withdrawals)
    - `/business/$businessDescriptor/accounting/assets`
- **State Management:**
    - URL-driven state for lists (page, filters).
    - React Query for data fetching (`accountingQueries`).
- **Forms:** Use `src/components/form/*` (zod schema validation).

### 6.3 Security & Permissions
- **RBAC:** `ActionView` vs `ActionManage` on `ResourceAccounting`.
- Members can view, but only Admins can manage (Create/Edit/Delete) finances by default.
    - *UX:* Disable/Hide "Add" buttons for `user` role.

---

## 7. Risks & Edge Cases

| Risk | Mitigation |
|------|------------|
| User enters wrong "Safe to Draw" logic (e.g. withdraws 1M) | Add warning: "This exceeds your calculated safe amount." (Soft block). |
| Recurring expenses duplicate manual entry | Clear UI distinction between "One-off" and "Recurring". |
| Categories don't match user needs | Start with broad, universally useful categories. (Misc/Other is fallback). |

## 8. Rollout Plan
- **Phase 1:** Internal & Beta. Verify "Safe to Draw" math feels right to users.
- **Phase 2:** Public rollout.
